Turbo Assembler	 Version 4.1	    12/02/25 22:29:53	    Page 1
main.ASM



      1				     ideal
      2				     dosseg
      3	0000			     model small
      4	0000			     stack 256
      5
      6	0100			     dataseg
      7	0000  00			 codsal	db 0
      8	0001  45 73 63 72 69 62	65+	 msg1 db 'Escribe la operacion a realizar: ', 0
      9	      20 6C 61 20 6F 70	65+
     10	      72 61 63 69 6F 6E	20+
     11	      61 20 72 65 61 6C	69+
     12	      7A 61 72 3A 20 00
     13	0023  45 6C 20 72 65 73	75+	 msg2 db 'El resultado es: ',0
     14	      6C 74 61 64 6F 20	65+
     15	      73 3A 20 00
     16	0035  15*(??)			 soper	db 21 dup(?)
     17	004A  14*(??)			 temp db 20 dup(?)
     18	005E  23*(??)			 sresul	db 35 dup(?)
     19	0081  ????????			 resul dd ?
     20
     21	0085  64 20 00			 sufDec	db 'd ', 0
     22	0088  68 20 00			 sufHex	db 'h ', 0
     23	008B  62 00			 sufBin	db 'b',	0
     24
     25	008D			     codeseg
     26					 extrn aputs:proc,astrcat:proc,agets:proc,sscan:proc,itoa:proc,itoa_hex:proc,itoa_bin:proc
     27	0000			     inicio:
     28	0000  B8 0000s			 mov ax,@data
     29	0003  8E D8			 mov ds,ax
     30	0005  8E C0			 mov es,ax
     31
     32	0007  C6 06 005Er 00		 mov [byte ptr sresul],	0
     33					 ; 1. Pedir dato - aprender bien a concatenar cadanas
     34	000C  BE 0001r			 mov si, offset	msg1
     35	000F  E8 0000e			 call aputs
     36
     37					 ; 2. Leer dato
     38	0012  BF 0035r			 mov di, offset	soper
     39	0015  B9 0014			 mov cx, 20
     40	0018  E8 0000e			 call agets
     41					 ;3. Separar cadenas
     42	001B  BE 0035r			 mov si, offset	soper
     43	001E  E8 0000e			 call sscan
     44
     45	0021  33 D2			 xor dx,dx
     46
     47	0023  80 F9 2B			 cmp cl,'+'
     48	0026  74 14			 je suma
     49
     50	0028  80 F9 2D			 cmp cl,'-'
     51	002B  74 14			 je resta
     52
     53	002D  80 F9 2A			 cmp cl,'*'
     54	0030  74 05			 je multi
     55
     56	0032			     divi:
     57	0032  F7 F3		     div bx
Turbo Assembler	 Version 4.1	    12/02/25 22:29:53	    Page 2
main.ASM



     58	0034  EB 0D 90		     jmp guardar
     59	0037			     multi:
     60	0037  F7 E3		     mul bx
     61	0039  EB 08 90		     jmp guardar
     62	003C			     suma:
     63	003C  03 C3		     add ax,bx
     64	003E  EB 03 90		     jmp guardar
     65	0041			     resta:
     66	0041  2B C3		     sub ax,bx
     67
     68	0043			     guardar:
     69	0043  A3 0081r		     mov [word resul],ax
     70	0046  89 16 0083r	     mov [word resul+2],dx
     71
     72					 ; 4. Formacion	de la cadena
     73
     74					 ; decimal
     75					 ; Convertir numero a temp
     76	004A  BF 004Ar			 mov di, offset	temp
     77	004D  E8 0000e			 call itoa
     78
     79					 ; Concatenar temp a sresul
     80	0050  BF 005Er			 mov di, offset	sresul
     81	0053  BE 004Ar			 mov si, offset	temp
     82	0056  E8 0000e			 call astrcat
     83
     84					 ; Concatenar sufijo d
     85	0059  BE 0085r			 mov si, offset	sufDec
     86	005C  E8 0000e			 call astrcat
     87
     88					 ; hexa
     89	005F  A1 0081r			 mov ax, [word ptr resul]
     90	0062  8B 16 0083r		 mov dx, [word ptr resul+2]
     91
     92	0066  BF 004Ar			 mov di, offset	temp
     93	0069  E8 0000e			 call itoa_hex
     94
     95	006C  BF 005Er			 mov di, offset	sresul
     96	006F  BE 004Ar			 mov si, offset	temp
     97	0072  E8 0000e			 call astrcat
     98
     99	0075  BE 0088r			 mov si, offset	sufHex
    100	0078  E8 0000e			 call astrcat
    101
    102					 ;binario
    103	007B  A1 0081r			 mov ax, [word ptr resul]
    104	007E  8B 16 0083r		 mov dx, [word ptr resul+2]
    105
    106	0082  BF 004Ar			 mov di, offset	temp
    107	0085  E8 0000e			 call itoa_bin
    108
    109	0088  BF 005Er			 mov di, offset	sresul
    110	008B  BE 004Ar			 mov si, offset	temp
    111	008E  E8 0000e			 call astrcat
    112
    113	0091  BE 008Br			 mov si, offset	sufBin
    114	0094  E8 0000e			 call astrcat
Turbo Assembler	 Version 4.1	    12/02/25 22:29:53	    Page 3
main.ASM



    115
    116					 ;mostramos el recultado final
    117	0097  BE 0023r			 mov si, offset	msg2
    118	009A  E8 0000e			 call aputs
    119
    120	009D  BE 005Er			 mov si, offset	sresul ; Imprimimos la cadena final
    121	00A0  E8 0000e			 call aputs
    122
    123	00A3			     fin:
    124	00A3  B4 4C			 mov ah, 04Ch
    125	00A5  A0 0000r			 mov al,[codsal]
    126	00A8  CD 21			 int 21h
    127
    128				     end inicio
Turbo Assembler	 Version 4.1	    12/02/25 22:29:53	    Page 4
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "12/02/25"
??FILENAME			  Text	 "main	  "
??TIME				  Text	 "22:29:53"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 MAIN
@INTERFACE			  Text	 000H
@MODEL				  Text	 2
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
AGETS				  Near	 _TEXT:---- Extern
APUTS				  Near	 _TEXT:---- Extern
ASTRCAT				  Near	 _TEXT:---- Extern
CODSAL				  Byte	 DGROUP:0000
DIVI				  Near	 _TEXT:0032
FIN				  Near	 _TEXT:00A3
GUARDAR				  Near	 _TEXT:0043
INICIO				  Near	 _TEXT:0000
ITOA				  Near	 _TEXT:---- Extern
ITOA_BIN			  Near	 _TEXT:---- Extern
ITOA_HEX			  Near	 _TEXT:---- Extern
MSG1				  Byte	 DGROUP:0001
MSG2				  Byte	 DGROUP:0023
MULTI				  Near	 _TEXT:0037
RESTA				  Near	 _TEXT:0041
RESUL				  Dword	 DGROUP:0081
SOPER				  Byte	 DGROUP:0035
SRESUL				  Byte	 DGROUP:005E
SSCAN				  Near	 _TEXT:---- Extern
SUFBIN				  Byte	 DGROUP:008B
SUFDEC				  Byte	 DGROUP:0085
SUFHEX				  Byte	 DGROUP:0088
SUMA				  Near	 _TEXT:003C
TEMP				  Byte	 DGROUP:004A

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  STACK				  16  0100 Para	  Stack	  STACK
  _DATA				  16  008D Word	  Public  DATA
_TEXT				  16  00AA Word	  Public  CODE
